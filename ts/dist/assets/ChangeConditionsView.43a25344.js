import{V as x,Z as j,D as _,C as M,a as D,v as Q,r as S,o,e as O,y as B,b as m,c as d,k as f,n as z,f as C,x as Z,m as G,d as I,T as J,E as T,W as H,X as N,G as A,H as L,I as p,h as V,s as $,F as w,Y as W,L as X,_ as U,$ as K,Q as ee,a0 as te,a1 as ne,w as ie,a2 as ue,i as se}from"./index.82a63ead.js";import{s as oe}from"./panel.esm.c6789fb7.js";import{O as re,s as F}from"./dropdown.esm.0ea7dd3e.js";import{u as q}from"./adminStore.70d21b42.js";import{a as ae}from"./admin.d584d80b.js";var Y={name:"ConfirmPopup",inheritAttrs:!1,props:{group:String},data(){return{visible:!1,confirmation:null}},target:null,outsideClickListener:null,scrollHandler:null,resizeListener:null,container:null,confirmListener:null,closeListener:null,mounted(){this.confirmListener=t=>{!t||t.group===this.group&&(this.confirmation=t,this.target=t.target,this.visible=!0)},this.closeListener=()=>{this.visible=!1,this.confirmation=null},x.on("confirm",this.confirmListener),x.on("close",this.closeListener)},beforeUnmount(){x.off("confirm",this.confirmListener),x.off("close",this.closeListener),this.unbindOutsideClickListener(),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.unbindResizeListener(),this.container&&(j.clear(this.container),this.container=null),this.target=null,this.confirmation=null},methods:{accept(){this.confirmation.accept&&this.confirmation.accept(),this.visible=!1},reject(){this.confirmation.reject&&this.confirmation.reject(),this.visible=!1},onEnter(t){this.bindOutsideClickListener(),this.bindScrollListener(),this.bindResizeListener(),j.set("overlay",t,this.$primevue.config.zIndex.overlay)},onLeave(){this.unbindOutsideClickListener(),this.unbindScrollListener(),this.unbindResizeListener()},onAfterLeave(t){j.clear(t)},alignOverlay(){_.absolutePosition(this.container,this.target);const t=_.getOffset(this.container),r=_.getOffset(this.target);let v=0;t.left<r.left&&(v=r.left-t.left),this.container.style.setProperty("--overlayArrowLeft",`${v}px`),t.top<r.top&&_.addClass(this.container,"p-confirm-popup-flipped")},bindOutsideClickListener(){this.outsideClickListener||(this.outsideClickListener=t=>{this.visible&&this.container&&!this.container.contains(t.target)&&!this.isTargetClicked(t)?this.visible=!1:this.alignOverlay()},document.addEventListener("click",this.outsideClickListener))},unbindOutsideClickListener(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener),this.outsideClickListener=null)},bindScrollListener(){this.scrollHandler||(this.scrollHandler=new M(this.target,()=>{this.visible&&(this.visible=!1)})),this.scrollHandler.bindScrollListener()},unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()},bindResizeListener(){this.resizeListener||(this.resizeListener=()=>{this.visible&&!_.isTouchDevice()&&(this.visible=!1)},window.addEventListener("resize",this.resizeListener))},unbindResizeListener(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)},isTargetClicked(t){return this.target&&(this.target===t.target||this.target.contains(t.target))},containerRef(t){this.container=t},onOverlayClick(t){re.emit("overlay-click",{originalEvent:t,target:this.target})}},computed:{containerClass(){return["p-confirm-popup p-component",{"p-input-filled":this.$primevue.config.inputStyle==="filled","p-ripple-disabled":this.$primevue.config.ripple===!1}]},message(){return this.confirmation?this.confirmation.message:null},iconClass(){return["p-confirm-popup-icon",this.confirmation?this.confirmation.icon:null]},acceptLabel(){return this.confirmation?this.confirmation.acceptLabel||this.$primevue.config.locale.accept:null},rejectLabel(){return this.confirmation?this.confirmation.rejectLabel||this.$primevue.config.locale.reject:null},acceptIcon(){return this.confirmation?this.confirmation.acceptIcon:null},rejectIcon(){return this.confirmation?this.confirmation.rejectIcon:null},acceptClass(){return["p-confirm-popup-accept p-button-sm",this.confirmation?this.confirmation.acceptClass:null]},rejectClass(){return["p-confirm-popup-reject p-button-sm",this.confirmation?this.confirmation.rejectClass||"p-button-text":null]}},components:{CPButton:D,Portal:Q}};const le={key:0,class:"p-confirm-popup-content"},ce={class:"p-confirm-popup-message"},pe={class:"p-confirm-popup-footer"};function de(t,r,v,s,a,n){const g=S("CPButton"),l=S("Portal");return o(),O(l,null,{default:B(()=>[m(J,{name:"p-confirm-popup",onEnter:n.onEnter,onLeave:n.onLeave,onAfterLeave:n.onAfterLeave},{default:B(()=>[a.visible?(o(),d("div",G({key:0,ref:n.containerRef,class:n.containerClass},t.$attrs,{onClick:r[2]||(r[2]=(...b)=>n.onOverlayClick&&n.onOverlayClick(...b))}),[t.$slots.message?(o(),O(Z(t.$slots.message),{key:1,message:a.confirmation},null,8,["message"])):(o(),d("div",le,[f("i",{class:z(n.iconClass)},null,2),f("span",ce,C(a.confirmation.message),1)])),f("div",pe,[m(g,{label:n.rejectLabel,icon:n.rejectIcon,class:z(n.rejectClass),onClick:r[0]||(r[0]=b=>n.reject())},null,8,["label","icon","class"]),m(g,{label:n.acceptLabel,icon:n.acceptIcon,class:z(n.acceptClass),onClick:r[1]||(r[1]=b=>n.accept()),autofocus:""},null,8,["label","icon","class"])])],16)):I("",!0)]),_:1},8,["onEnter","onLeave","onAfterLeave"])]),_:1})}function fe(t,r){r===void 0&&(r={});var v=r.insertAt;if(!(!t||typeof document>"u")){var s=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",v==="top"&&s.firstChild?s.insertBefore(a,s.firstChild):s.appendChild(a),a.styleSheet?a.styleSheet.cssText=t:a.appendChild(document.createTextNode(t))}}var me=`
.p-confirm-popup {
    position: absolute;
    margin-top: 10px;
    top: 0;
    left: 0;
}
.p-confirm-popup-flipped {
    margin-top: 0;
    margin-bottom: 10px;
}

/* Animation */
.p-confirm-popup-enter-from {
    opacity: 0;
    -webkit-transform: scaleY(0.8);
            transform: scaleY(0.8);
}
.p-confirm-popup-leave-to {
    opacity: 0;
}
.p-confirm-popup-enter-active {
    -webkit-transition: opacity 0.12s cubic-bezier(0, 0, 0.2, 1), -webkit-transform 0.12s cubic-bezier(0, 0, 0.2, 1);
    transition: opacity 0.12s cubic-bezier(0, 0, 0.2, 1), -webkit-transform 0.12s cubic-bezier(0, 0, 0.2, 1);
    transition: transform 0.12s cubic-bezier(0, 0, 0.2, 1), opacity 0.12s cubic-bezier(0, 0, 0.2, 1);
    transition: transform 0.12s cubic-bezier(0, 0, 0.2, 1), opacity 0.12s cubic-bezier(0, 0, 0.2, 1), -webkit-transform 0.12s cubic-bezier(0, 0, 0.2, 1);
}
.p-confirm-popup-leave-active {
    -webkit-transition: opacity 0.1s linear;
    transition: opacity 0.1s linear;
}
.p-confirm-popup:after,
.p-confirm-popup:before {
    bottom: 100%;
    left: calc(var(--overlayArrowLeft, 0) + 1.25rem);
    content: ' ';
    height: 0;
    width: 0;
    position: absolute;
    pointer-events: none;
}
.p-confirm-popup:after {
    border-width: 8px;
    margin-left: -8px;
}
.p-confirm-popup:before {
    border-width: 10px;
    margin-left: -10px;
}
.p-confirm-popup-flipped:after,
.p-confirm-popup-flipped:before {
    bottom: auto;
    top: 100%;
}
.p-confirm-popup.p-confirm-popup-flipped:after {
    border-bottom-color: transparent;
}
.p-confirm-popup.p-confirm-popup-flipped:before {
    border-bottom-color: transparent;
}
.p-confirm-popup .p-confirm-popup-content {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-align: center;
        -ms-flex-align: center;
            align-items: center;
}
`;fe(me);Y.render=de;const he={class:"popup"},ve={key:0},be={key:1},Ce={key:2},ge={key:3},Ee=T({__name:"CreateConditionsPopupComponent",setup(t){const r=H(),v=(u,i,e)=>{r.add({severity:u,summary:i,detail:e,life:3e3})},s=q(),a=N(),n=A(()=>a.isPopupVisible),g=A(()=>s.conditionColumns),l=L(a.createPopupFields(g.value)),b=L(!1),y=L(""),k=L(""),P=()=>{if(b.value=!1,!l.value.name.length){v("error","\u041E\u0448\u0438\u0431\u043A\u0430","\u041F\u043E\u043B\u0435 '\u041D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435 \u0432\u043E\u043F\u0440\u043E\u0441\u0430' \u0434\u043E\u043B\u0436\u043D\u043E \u0431\u044B\u0442\u044C \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u043E");return}if(!l.value.compare.length){v("error","\u041E\u0448\u0438\u0431\u043A\u0430","\u041F\u043E\u043B\u0435 '\u0423\u0441\u043B\u043E\u0432\u0438\u0435' \u0434\u043E\u043B\u0436\u043D\u043E \u0431\u044B\u0442\u044C \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u043E");return}if(!l.value.value.length){v("error","\u041E\u0448\u0438\u0431\u043A\u0430","\u041F\u043E\u043B\u0435 '\u0417\u043D\u0430\u0447\u0435\u043D\u0438\u0435' \u0434\u043E\u043B\u0436\u043D\u043E \u0431\u044B\u0442\u044C \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u043E");return}if(/\D/.test(l.value.testCase)||!l.value.testCase.length){v("error","\u041E\u0448\u0438\u0431\u043A\u0430","\u041D\u043E\u043C\u0435\u0440 \u0440\u0435\u043A\u043E\u043C\u0435\u043D\u0434\u0430\u0446\u0438\u0438 \u0434\u043E\u043B\u0436\u0435\u043D \u0441\u043E\u0441\u0442\u043E\u044F\u0442\u044C \u0438\u0437 \u0446\u0438\u0444\u0440");return}b.value=!0},h=()=>{if(P(),b.value){const u={...l.value},i=s.questions.filter(e=>e.name===y.value)[0];u.multiple=(i==null?void 0:i.maxSelectedChoices)>1,u.type=i.type,u.value=k.value.split(","),s.createConditionInRec(u,y.value),v("success","\u0423\u0441\u043F\u0435\u0448\u043D\u043E","\u0423\u0441\u043B\u043E\u0432\u0438\u0435 \u0441\u043E\u0437\u0434\u0430\u043D\u043E"),c()}},c=()=>{l.value=a.createPopupFields(g.value),a.closePopup()};return(u,i)=>(o(),O(p(X),{visible:p(n),"onUpdate:visible":i[4]||(i[4]=e=>W(n)?n.value=e:null),modal:"",draggable:"",closable:!1,header:"\u0421\u043E\u0437\u0434\u0430\u043D\u0438\u0435 \u043D\u043E\u0432\u043E\u0433\u043E \u0443\u0441\u043B\u043E\u0432\u0438\u044F",style:{width:"50vw"}},{footer:B(()=>[m(p(D),{label:"\u041E\u0442\u043C\u0435\u043D\u0438\u0442\u044C \u0441\u043E\u0437\u0434\u0430\u043D\u0438\u0435",icon:"pi pi-times",class:"p-button-text",onClick:i[2]||(i[2]=e=>c())}),m(p(D),{label:"\u0421\u043E\u0437\u0434\u0430\u0442\u044C",icon:"pi pi-check",class:"p-button-success",autofocus:"",onClick:i[3]||(i[3]=e=>h())})]),default:B(()=>[f("div",he,[(o(!0),d(w,null,V(p(g),(e,R)=>(o(),d("div",{key:R},[e.hasDropdown?(o(),d("div",ve,[f("h3",null,C(e.header),1),m(p(F),{modelValue:l.value[e.field],"onUpdate:modelValue":E=>l.value[e.field]=E,options:e==null?void 0:e.options,"option-value":"value","option-label":"value",placeholder:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435...",style:{"max-width":"100%",height:"100%"},"filter-placeholder":"\u041F\u043E\u0438\u0441\u043A",filter:"",lazy:"","empty-filter-message":"\u041D\u0438\u0447\u0435\u0433\u043E \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u043E","empty-message":"\u041D\u0438\u0447\u0435\u0433\u043E \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u043E"},null,8,["modelValue","onUpdate:modelValue","options"])])):e.field==="name"?(o(),d("div",be,[f("h3",null,C(e.header),1),m(p(F),{modelValue:y.value,"onUpdate:modelValue":i[0]||(i[0]=E=>y.value=E),options:e==null?void 0:e.options,"option-value":"value","option-label":"value",placeholder:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435...",style:{"max-width":"100%",height:"100%"},"filter-placeholder":"\u041F\u043E\u0438\u0441\u043A",filter:"",lazy:"","empty-filter-message":"\u041D\u0438\u0447\u0435\u0433\u043E \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u043E","empty-message":"\u041D\u0438\u0447\u0435\u0433\u043E \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u043E"},null,8,["modelValue","options"])])):e.field==="value"?(o(),d("div",Ce,[f("h3",null,C(e.header),1),m(p($),{modelValue:k.value,"onUpdate:modelValue":i[1]||(i[1]=E=>k.value=E),style:{width:"100%"}},null,8,["modelValue"])])):(o(),d("div",ge,[f("h3",null,C(e.header),1),m(p($),{modelValue:l.value[e.field],"onUpdate:modelValue":E=>l.value[e.field]=E,style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue"])]))]))),128))])]),_:1},8,["visible"]))}});const ye=U(Ee,[["__scopeId","data-v-19e56649"]]),Le={class:"section-recommendations-change"},De={class:"recommendation-nav"},ke=["for"],_e=["id","value"],we={key:0,class:"recommendation-body"},Be=T({__name:"ChangeConditionsView",setup(t){const r=H(),v=K(),s=q(),a=N(),n=L(""),g=L({});ee(()=>{s.recommendations.length||s.getRecommendationsData(),s.questions.length||s.getQuestionsData()});const l=A(()=>s.recommendations);te(n,h=>{g.value=l.value.filter(c=>c.name===h)[0]});const b=(h,c,u)=>{r.add({severity:h,summary:c,detail:u,life:3e3})},y=(h,c)=>{s.checkedRecommendationName=h,s.conditionIndex=c,a.openPopup()},k=async()=>{var c;const h=await s.saveConditionsData(n.value);if(h.status===200)b("success","\u0423\u0441\u043F\u0435\u0448\u043D\u043E","\u0418\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u044F \u0432\u043D\u0435\u0441\u0435\u043D\u044B");else if(ae.isAxiosError(h)){const u=(c=h.response)==null?void 0:c.data;b("error","\u041E\u0448\u0438\u0431\u043A\u0430",u.ERROR)}},P=(h,c,u,i)=>{v.require({target:h.currentTarget,message:"\u0412\u044B \u0443\u0432\u0435\u0440\u0435\u043D\u044B?",acceptLabel:"\u0414\u0430",rejectLabel:"\u041D\u0435\u0442",icon:"pi pi-info-circle",acceptClass:"p-button-danger",accept:()=>{s.deleteConditionByIndex(c,u,i)}})};return(h,c)=>(o(),d(w,null,[m(p(ne)),m(p(Y)),f("section",Le,[f("div",De,[(o(!0),d(w,null,V(p(l),(u,i)=>(o(),d("label",{key:i,for:`${i}`,class:z(["label",{checked:n.value===u.name}])},[ie(f("input",{id:`${i}`,"onUpdate:modelValue":c[0]||(c[0]=e=>n.value=e),type:"radio",class:"hidden",value:u.name},null,8,_e),[[ue,n.value]]),se(" "+C(u.name),1)],10,ke))),128))]),n.value!==""?(o(),d("div",we,[(o(!0),d(w,null,V(g.value.conditions,(u,i)=>(o(),O(p(oe),{key:i,header:`${i+1}`,toggleable:!0,collapsed:!0},{default:B(()=>[m(p(D),{icon:"pi pi-plus",class:"p-button-rounded p-button-success p-button-outlined create-rec-btn",onClick:e=>y(n.value,i)},null,8,["onClick"]),(o(!0),d(w,null,V(Object.keys(u),(e,R)=>(o(),d("div",{key:R,class:"condition-item"},[f("p",null,C(e),1),f("p",null,C(u[e].compare),1),f("p",null,C(u[e].value.join(",")),1),f("p",null,C(u[e].testCase),1),m(p(D),{icon:"pi pi-times",class:"p-button-rounded p-button-danger p-button-outlined",onClick:E=>P(E,n.value,i,e)},null,8,["onClick"])]))),128))]),_:2},1032,["header"]))),128)),m(p(D),{label:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C",class:"p-button-lg",onClick:k})])):I("",!0)]),m(ye)],64))}});const Re=U(Be,[["__scopeId","data-v-fb403a44"]]);export{Re as default};
